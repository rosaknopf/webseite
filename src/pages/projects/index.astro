---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";
import { siteConfig } from "../../data/siteConfig";

const projects = (await getCollection("projects")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<Layout
    title={`Projekte | ${siteConfig.title}`}
    description="Unsere aktuellen und vergangenen Projekte."
>
    <section class="max-w-6xl mx-auto py-12">
        <h1
            class="text-4xl md:text-5xl font-serif text-center text-rose-950 mb-4"
        >
            Unsere Projekte
        </h1>
        <p class="text-center text-rose-700/80 mb-16 max-w-2xl mx-auto">
            Hier zeigen wir, woran wir gerade arbeiten oder was bereits
            fertiggestellt wurde.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
            {
                projects.map((project) => (
                    <a
                        href={`/projects/${project.slug}/`}
                        class="group block bg-white rounded-3xl overflow-hidden shadow-sm hover:shadow-xl transition border border-rose-50 flex flex-col md:flex-row h-full"
                    >
                        <div class="md:w-1/2 aspect-[4/3] md:aspect-auto overflow-hidden bg-rose-100 relative">
                            {project.data.heroImage ? (
                                <img
                                    src={project.data.heroImage}
                                    alt=""
                                    class="w-full h-full object-cover transform group-hover:scale-105 transition duration-500"
                                />
                            ) : (
                                <div class="w-full h-full flex items-center justify-center text-rose-300 bg-rose-50">
                                    <span class="text-4xl opacity-20">ðŸ”¨</span>
                                </div>
                            )}
                            <div class="absolute top-4 left-4">
                                <span
                                    class={`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${project.data.status === "Completed" ? "bg-green-100 text-green-800" : "bg-amber-100 text-amber-800"}`}
                                >
                                    {project.data.status === "Completed"
                                        ? "Fertiggestellt"
                                        : "In Arbeit"}
                                </span>
                            </div>
                        </div>
                        <div class="p-8 md:w-1/2 flex flex-col justify-center">
                            <div class="text-xs text-rose-400 font-medium mb-2 uppercase tracking-wide">
                                {project.data.pubDate.toLocaleDateString(
                                    "de-DE",
                                )}
                            </div>
                            <h2 class="text-2xl font-serif font-bold text-rose-900 mb-4 group-hover:text-rose-600 transition">
                                {project.data.title}
                            </h2>
                            <p class="text-rose-700/80 mb-6 flex-grow">
                                {project.data.description}
                            </p>
                            <span class="text-rose-600 font-medium group-hover:translate-x-1 transition-transform inline-block">
                                Projekt ansehen â†’
                            </span>
                        </div>
                    </a>
                ))
            }
        </div>
    </section>
</Layout>
