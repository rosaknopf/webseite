---
import Layout from "../layouts/Layout.astro";
import { siteConfig } from "../data/siteConfig";
import { getEntry } from "astro:content";
import { Image } from "astro:assets";

// Fetch Homepage Content
const homeEntry = await getEntry("pages", "home");
const { hero, features, intro } = homeEntry.data;
---

<Layout title={siteConfig.title}>
	<!-- Hero Section -->
	<section
		class="relative bg-rose-100 rounded-3xl overflow-hidden mb-16 min-h-[500px] flex items-center justify-center text-center px-4"
	>
		<div class="absolute inset-0 z-0 opacity-40">
			<Image
				src={hero.image}
				alt="Hero Background"
				class="w-full h-full object-cover"
				width={1600}
				densities={[1, 2]}
			/>
		</div>

		<div
			class="relative z-10 max-w-2xl bg-white/80 backdrop-blur-md p-8 rounded-2xl shadow-xl border border-rose-100"
		>
			<h1
				class="text-4xl md:text-6xl font-serif font-bold text-rose-950 mb-4"
				set:html={hero.title.replace(/\n/g, "<br/>")}
			/>
			<p class="text-lg text-gray-700 mb-8 font-light">
				{hero.subtitle}
			</p>
			<a
				href={hero.buttonLink}
				class="inline-block bg-rose-600 hover:bg-rose-700 text-white font-medium py-3 px-8 rounded-full transition shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
			>
				{hero.buttonText}
			</a>
		</div>
	</section>

	<!-- Categories Grid -->
	<section class="mb-20">
		<h2 class="text-3xl font-serif text-center text-rose-950 mb-12">
			Entdecken Sie mehr
		</h2>
		<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
			{
				features.map((cat: any) => (
					<a
						href={cat.link}
						class="group relative block overflow-hidden rounded-2xl shadow-md hover:shadow-xl transition"
					>
						<div class="aspect-[4/3] overflow-hidden">
							<Image
								src={cat.image}
								alt={cat.title}
								class="w-full h-full object-cover transform group-hover:scale-105 transition duration-500"
								width={600}
								densities={[1.5, 2]}
							/>
						</div>
						<div class="absolute inset-0 bg-gradient-to-t from-gray-900/70 to-transparent flex items-end p-6">
							<h3 class="text-white text-xl font-serif font-medium group-hover:underline decoration-rose-400 decoration-2 underline-offset-4">
								{cat.title}
							</h3>
						</div>
					</a>
				))
			}
		</div>
	</section>

	<!-- About / Introduction Teaser -->
	<section
		class="mb-20 grid md:grid-cols-2 gap-12 items-center bg-white p-8 md:p-12 rounded-3xl shadow-sm border border-rose-100"
	>
		<div class="order-2 md:order-1">
			<h2 class="text-3xl font-serif text-rose-950 mb-6">
				{intro.title}
			</h2>
			<p class="text-gray-700 leading-relaxed mb-6">
				{intro.text}
			</p>
			<a
				href={intro.linkUrl}
				class="text-rose-600 font-medium hover:text-rose-700 underline decoration-rose-300 underline-offset-4"
			>
				{intro.linkText} &rarr;
			</a>
		</div>
		<div
			class="order-1 md:order-2 aspect-square rounded-2xl overflow-hidden bg-rose-100"
		>
			<Image
				src={intro.image}
				alt="About Us"
				class="w-full h-full object-cover"
				width={800}
				densities={[1.5, 2]}
			/>
		</div>
	</section>

	<!-- Instagram / Social Feed Placeholder -->
	<!-- Instagram / Social Feed Gallery -->
	{
		homeEntry.data.instagram?.enabled && (
			<section class="text-center mb-16">
				<h2 class="text-2xl font-serif text-rose-950 mb-2">
					{homeEntry.data.instagram.title}
				</h2>
				<a
					href={siteConfig.social.instagram}
					class="text-rose-500 mb-8 inline-block hover:text-rose-600 hover:underline transition"
					target="_blank"
				>
					@{siteConfig.social.instagram.split("/").pop()}
				</a>
				<div class="grid grid-cols-2 md:grid-cols-4 gap-4">
					{homeEntry.data.instagram.images.map((post: any) => (
						<a
							href={post.link || siteConfig.social.instagram}
							target="_blank"
							class="aspect-square bg-rose-50 rounded-lg overflow-hidden relative group cursor-pointer block border border-rose-50"
						>
							<Image
								src={post.image}
								alt="Instagram Post"
								class="w-full h-full object-cover transform group-hover:scale-110 transition duration-700"
								width={400}
								densities={[1.5, 2]}
							/>
							<div class="absolute inset-0 bg-rose-900/0 group-hover:bg-rose-900/30 transition duration-300 flex items-center justify-center">
								<span class="opacity-0 group-hover:opacity-100 text-white text-3xl transition transform scale-50 group-hover:scale-100 shadow-sm">
									ü§ç
								</span>
							</div>
						</a>
					))}
				</div>
			</section>
		)
	}
</Layout>
